# Approx-Tools

A repository for various useful tools for building polynomial and rational approximations to functions on both complex and real domains. The point of this repository is to make such tools more easily accessible, as many such tools are locked behind the paywall of Matlab like Chebfun (which doesn't work in GNU Octave either), or are entirely proprietary (and also locked behind paywalls) like the Remez function in Maple. The few tools that do exist are often difficult to find, difficult to use, or just generally unfinished.

Currently implemented here is the Carathéodory-Fejér method for creating rational approximations of type (m,n) (allowing m=0 or n=0), and an implementation of Chebyshev interpolation. These are extremely close to the minimax rationals generated by the Remez algorithm, whilst being much simpler algorithms to implement.

Three functions are implemented, CF for approximating a given complex function on the unit disc |z| <= 1, RCF for approximating a given real function on the interval [-1,1], and Cheb for performing Chebyshev interpolation on [-1,1]. I will try making tools for transforming these domains later. It is worth noting that for n=0, the Taylor polynomials are near-optimal on the unit disc, and in fact that is what CF will generate in these cases.

## Example
```
>>>a = CF(acb.exp,1,1,512,30)
>>>a
(array([[1.000000000000000000 +/- 8.26e-20],
       [0.565834159749634457 +/- 4.84e-19]], dtype=object), [[1.0000000000000000000 +/- 1e-24], [-0.43416584025036554323 +/- 1.09e-21]], [0.084548725942226552741 +/- 2.64e-22])
```

This output corresponds to the rational (1 + 0.565834159749634457*x)/(1 - 0.43416584025036554323*x). As an approximation to exp(x) on the unit disc, this gives an estimated maximum error (in the infinity norm sense) of 0.08454872594222647.
For RCF this error estimate is usually very accurate, and in both cases it becomes more accurate with increasing n and m. This can be tested with the `test_error` function:

```
>>>test_error(acb.exp,a[0],a[1],real=False)
[0.110642311854810176 +/- 9.20e-19]
```
Compare this to the (1,1) Pade approximation to `exp(z)`,
```
>>>test_error(acb.exp,[1,1/2],[1,-1/2],real=False)
[0.28171817154095476463971252864733750224275290630004 +/- 7.68e-51]
```
Now let's try approximating `exp(x)` on the unit interval instead:
```
>>>a = RCF(acb.exp,5,0,512,40)
>>>a
([[1.2660658777520355910 +/- 5.64e-20], [1.130318207984786543 +/- 5.89e-19], [0.2714953395045225503 +/- 7.59e-20], [0.044336848721418943 +/- 1.09e-19], [0.0054742120467595213 +/- 5.76e-20], [0.000546136937595971 +/- 4.61e-19]], [1.0000000000000000000], [4.5205511926115825793e-5 +/- 1.93e-25])
>>>test_error(acb.exp,a[0],a[1],real=True)
[4.520551192612e-5 +/- 8.63e-18]
```

<b> warning: RCF and Cheb return coefficients in the Chebyshev basis, there is a `to_monomial` function for converting if necessary, and an implementation of the clenshaw algorithm for evaluating polynomials in the Chebyshev basis.</b>

In this case, the CF polynomial of order 5 is calculated. Using [lolremez](https://github.com/samhocevar/lolremez), the true minimax polynomial can be calculated, which has an error of 4.5205511926115826e-5, matching to around 12 significant figures.

## Known issues

Trying to approximate some functions, e.g `cos` causes errors, this is because so many (or any?) of the Taylor coefficients are 0. The solution to this is to instead approximate something like `cos(sqrt(y))`, with the expectation that the input to the function is now `y = x**2`, eliminating any zero coefficients. I recommend reading [this](https://github.com/samhocevar/lolremez/wiki/Tutorial-3-of-5%3A-changing-variables-for-simpler-polynomials) for more details.

## References

The code has been translated from the Matlab implementations described [here](https://people.maths.ox.ac.uk/trefethen/matlabCF.pdf) and [here](https://www.chebfun.org/examples/approx/CF30.html)

Most the 'modern' literature on the topic of CF approximation seems to have been covered by Lloyd N. Trefethen (author of the above Matlab code) in 1984, this presentation gives a good overview of the literature and main results [here](https://people.maths.ox.ac.uk/trefethen//cftalk.pdf).

The fast, FFT based method for Chebyshev interpolation in the Chebyshev basis was first described by [Ahmed and Fisher](http://dx.doi.org/10.1080/00207167008803043), which is the implementation I have followed. This method is extremely fast, simple and stable, and can easily generate polynomials in the order of hundreds of thousands.

One tool I would like to highlight is [lolremez](https://github.com/samhocevar/lolremez), which provides a solid implementation of the Remez algorithm for calculating minimax polynomial approximations. There is also a related [blog post](https://lolengine.net/blog/2011/12/21/better-function-approximations) which explains (rather informally) the need for such approximations too.
